## Table: Activity

| Column Name   | Type  |
|---------------|-------|
| machine_id    | int   |
| process_id    | int   |
| activity_type | enum  |
| timestamp     | float |

- (`machine_id`, `process_id`, `activity_type`) is the primary key.
- `machine_id` is the ID of a machine.
- `process_id` is the ID of a process running on that machine.
- `activity_type` is either `'start'` or `'end'`.
- `timestamp` represents time in seconds.
- For every `(machine_id, process_id)`, there is exactly one `'start'` and one `'end'`.
- `'start'` timestamp is always before `'end'`.

---

## Problem Statement

Find the **average time each machine takes to complete a process**.

- Time for one process = `end timestamp - start timestamp`
- Average time =  
  `(total time for all processes on the machine) / (number of processes)`
- Round the result to **3 decimal places**.

Return the result table in **any order**.

---sdsw

## Example 1

### Input

**Activity table:**

| machine_id | process_id | activity_type | timestamp |
|------------|------------|---------------|-----------|
| 0          | 0          | start         | 0.712     |
| 0          | 0          | end           | 1.520     |
| 0          | 1          | start         | 3.140     |
| 0          | 1          | end           | 4.120     |
| 1          | 0          | start         | 0.550     |
| 1          | 0          | end           | 1.550     |
| 1          | 1          | start         | 0.430     |
| 1          | 1          | end           | 1.420     |
| 2          | 0          | start         | 4.100     |
| 2          | 0          | end           | 4.512     |
| 2          | 1          | start         | 2.500     |
| 2          | 1          | end           | 5.000     |

---

### Output

| machine_id | processing_time |
|------------|-----------------|
| 0          | 0.894           |
| 1          | 0.995           |
| 2          | 1.456           |

---

### Explanation

- Machine `0`: `((1.520 − 0.712) + (4.120 − 3.140)) / 2 = 0.894`
- Machine `1`: `((1.550 − 0.550) + (1.420 − 0.430)) / 2 = 0.995`
- Machine `2`: `((4.512 − 4.100) + (5.000 − 2.500)) / 2 = 1.456`

---

## Answer

```sql
select machine_id,
       round(
           avg(case when activity_type = 'end' then timestamp end)
         - avg(case when activity_type = 'start' then timestamp end),
           3
       ) as processing_time
from Activity
group by machine_id;

