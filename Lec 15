-- CTE in SQL (Common Table Expression), Clause 
-- This is used to simplify complex queries and improve the readability of the query.
 

Q. avg num of orders placed by each customer

Solution 1 (subquery)
=====================
select avg(total_orders_per_customer) as avg_orders_per_customer from ( select order_customer_id, count(*) as total_orders_per_customer from orders group by order_customer_id) x


Solution 2 (CTE/WITH CLAUSE)
=====================
WITH total_orders (order_customer_id, total_orders_per_customer) as (select order_customer_id, count(*) as total_orders_per_customer from orders group by order_customer_id)
select avg(total_orders_per_customer) as avg_orders_per_customer from total_orders


subquery
=====================
query3(query2(query1))

CTE
=====================
query1
query2
query3






















